<html>
<head></head>
<body><div id="cntr"></div></body>
<script>
//http://freelargephotos.com/000995_l.jpg
var iframe = document.createElement('iframe');
iframe.setAttribute("id","iframe");
var ctnr = document.getElementById('cntr');
var content = '<!DOCTYPE html>'
 + '<head><title>Dynamic iframe</title>'
 + '<body><div id="innerCtnr"></div>'
 + '<script>'
 + 'var downloadingImage = new Image();'
 +'downloadingImage.onerror = function(e){console.log("err",e);};'
 +'downloadingImage.onload = function(e){console.log("ldd",this.src,this);'
  + 'parent.postMessage("Hello","*");'
 +'};'
 +'downloadingImage.src = "http://freelargephotos.com/002995_l.jpg";'
 + '<\/script>' + '</body></html>';

ctnr.appendChild(iframe);

iframe.contentWindow.document.open('text/htmlreplace');
iframe.contentWindow.document.write(content);
iframe.contentWindow.document.close();
window.addEventListener('message',function(e){
	console.log("message",e);
});
setTimeout(function(){
//console.log('iframe.contentWindow =', iframe.contentWindow);
iframe.contentWindow.stop();
//window.frames[0].stop();
},200);
//document.body.appendChild(iframe);

</script>
</html>